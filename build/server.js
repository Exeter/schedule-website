function padTwo(a){var b=a.toString();return 1===b.length?"0"+b:b}function time_to_ms(a,b,c,d,e){return new Date(a,b,c,d,e,0,0).getTime()}function ms_to_date(a){var b=new Date(0);return b.setUTCSeconds(a/1e3),b}function getMonDate(a){var b=ms_to_date(a),c=b.getDay(),d=b.getDate()-c+(0===c?-6:1);if(b.setDate(d),1!==b.getDay())throw new Error("WRONG");return b}function getMonDay(a){var b=getMonDate(a);return padTwo(b.getMonth()+1)+"."+padTwo(b.getDate())+"."+b.getFullYear()}function getMonTime(a){var b=getMonDate(a);return b.getTime()}function getWeekDay(a){var b=ms_to_date(a);return b.getDay()}function getDuration(a){return null!=a.match(/^[abcdefghituvwxyzq]$/)?defaults_obj.symbols.format.lowercase*MS_PER_MIN:null!=a.match(/^[ABCDEFGHI]$/)?defaults_obj.symbols.format.uppercase*MS_PER_MIN:defaults_obj.symbols[a].minutes*MS_PER_MIN}function getColor(a){return a in format_to_color?format_to_color[a]:format_to_color["*"]}function generateEvents(a,b){var c,d,e,f=(b.days[getWeekDay(a)]||{}).events||[],g=a+288e5,h=[];for(c=0;c<f.length;c++)d=f[c],e=getDuration(d),h.push({id:Math.random(),title:d,color:getColor(d),start:g,end:g+e}),g+=e;return h}var fs=require("fs"),express=require("express"),url=require("url"),year_obj=JSON.parse(fs.readFileSync("year.json")),week1_obj=JSON.parse(fs.readFileSync("week1.json")),week2_obj=JSON.parse(fs.readFileSync("week2.json")),weeks={week1:week1_obj,week2:week2_obj},defaults_obj=JSON.parse(fs.readFileSync("defaults.json")),format_to_color={a:"#F7FE2E",t:"#F7FE2E",b:"#58FA58",u:"#58FA58",c:"#2ECCFA",v:"#2ECCFA",d:"#CC2EFA",w:"#CC2EFA",e:"#FE2E2E",x:"#FE2E2E",f:"#088A08",y:"#088A08",g:"#FF8000",z:"#FF8000",h:"#045FB4",q:"#045FB4","*":"#BDBDBD"};for(var key in format_to_color)format_to_color[key.toUpperCase()]=format_to_color[key];var MS_PER_MIN=6e4,all_events={};console.log(year_obj.schedules["10.13.2014"]);var app=express();app.use("/bower_components",express.static("bower_components")),app.get("/events",function(a,b){var c=Number(a.query.from),d=(Number(a.query.to),getMonDay(c)),e=year_obj.schedules[d];asdf=console.log("Looking up ",d,e),events=generateEvents(c,weeks[e.calendar]),b.send(JSON.stringify({success:!0,result:events}))}),app.use("/",express.static(".")),app.listen(process.env.PORT,function(){console.log("Listening on port",process.env.PORT)});